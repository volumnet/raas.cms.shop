(()=>{"use strict";var e={262:(e,t)=>{t.A=(e,t)=>{const l=e.__vccOpts||e;for(const[e,a]of t)l[e]=a;return l}}},t={};const l=Vue,a={class:"priceloader"};const o={class:"priceloader-steps"},r={class:"priceloader-steps__list"};const n={props:{step:{type:Number,default:0}},methods:{getStepHref(e){let t=window.location.search;return t=t.replace(/(\?|&)step=\w+/gi,""),e&&(t+=(t?"&":"?")+"step="+e),t}}};var s=function l(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,l),r.exports}(262);const i=(0,s.A)(n,[["render",function(e,t,a,n,s,i){return(0,l.openBlock)(),(0,l.createElementBlock)("nav",o,[(0,l.createElementVNode)("ul",r,[((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(["UPLOAD","MATCHING","APPLY","DONE"],((t,o)=>(0,l.createElementVNode)("li",{class:(0,l.normalizeClass)(["priceloader-steps__item",{"priceloader-steps__item_proceed":a.step>o,"priceloader-steps__item_active":a.step==o}])},[((0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(a.step>o&&a.step<3?"a":"span"),{href:i.getStepHref(o),class:"priceloader-steps__link"},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$root.translations["PRICELOADER_STEP_"+t]),1)])),_:2},1032,["href"]))],2))),64))])])}],["__scopeId","data-v-aa45ffe0"]]),c={action:"",method:"post",enctype:"multipart/form-data",class:"priceloader-form form-horizontal"},d={class:"priceloader-form__inner"},p={class:"alert alert-warning"},m=["innerHTML"],u={class:"control-group"},h={for:"cat_id",class:"control-label"},V={class:"controls"},f={class:"priceloader-form__table"},y={class:"alert alert-warning"},g={class:"priceloader-form__table"},E={class:"alert alert-success"},k={class:"priceloader-form__table"},N={class:"alert alert-warning"},_=["innerHTML"],v={class:"priceloader-form__file"},b={class:"priceloader-form__controls"},B=["href"],C=["onclick"],D=["href"];const w=["accept"];const S={methods:{inputMask(e={}){let t=Object.assign({showMaskOnFocus:!1,showMaskOnHover:!0},e),l=$(this.$el).add($("input",this.$el));l.filter("[pattern]:not([data-inputmask-pattern]):not([data-no-inputmask])").each((function(){var e=$(this).attr("pattern");$(this).attr("data-inputmask-pattern",e).attr("autocomplete","off").inputmask(Object.assign({regex:e},t))})),l.filter('[type="tel"]:not([pattern]):not([data-inputmask-pattern]):not([data-no-inputmask])').attr("data-inputmask-pattern","+9 (999) 999-99-99").attr("autocomplete","off").inputmask("+9 (999) 999-99-99",t),l.filter('[data-type="email"]:not([pattern]):not([data-inputmask-pattern]):not([data-no-inputmask])').attr("data-inputmask-pattern","*{+}@*{+}.*{+}").attr("autocomplete","off").inputmask("*{+}@*{+}.*{+}",t)},applyInputMaskListeners(){$(this.$el).add($("input",this.$el)).filter("[data-inputmask-pattern]:not([data-inputmask-events])").on("input",(e=>{this.$emit("update:modelValue",this.pValue=e.target.value)})).on("change",(e=>{this.$emit("update:modelValue",this.pValue=e.target.value)})).on("keydown",(e=>{this.$emit("update:modelValue",this.pValue=e.target.value)})).attr("data-inputmask-events","true")}}},I={mixins:[{mixins:[{props:{type:{type:[String,Object],default:"text"},modelValue:{},source:{}},emits:["update:modelValue"],mixins:[S],inheritAttrs:!1,data(){return{pValue:this.modelValue}},mounted(){this.inputMask(),this.applyInputMaskListeners()},updated(){this.inputMask(),this.applyInputMaskListeners()},methods:{setPValue(e){this.pValue=e},getFlatSource(e,t=0){let l=[];for(let a of e){let e={value:a.value,name:a.name||a.caption,level:t};a.disabled&&(e.disabled=!0),l.push(e),a.children&&(l=l.concat(this.getFlatSource(a.children,t+1)))}return l}},computed:{resolvedAttrs(){let e={...this.$attrs};return"object"==typeof this.type&&(e.is="raas-field-"+(this.type.datatype||"text"),this.type.datatype&&(e.type=this.type.datatype),this.type.urn&&(e.name=this.type.urn),this.type.htmlId&&(e.id=this.type.htmlId),this.type.stdSource&&(e.source=this.type.stdSource),this.type.accept&&(e.accept=this.type.accept),this.type.pattern&&(e.pattern=this.type.pattern),this.type.disabled&&(e.disabled=this.type.disabled),this.type.class&&(e.class=Object.assign({},e.class||{},this.type.class)),this.type.className&&(e.class=Object.assign({},e.class||{},this.type.className)),-1!=["number","range"].indexOf(this.type.datatype)&&(this.type.min_val&&(e.min=this.type.min_val),this.type.max_val&&(e.max=this.type.max_val),this.type.step&&(e.step=this.type.step)),this.type.defval&&-1!=["checkbox","radio"].indexOf(this.type.datatype)&&(e.defval=this.type.defval),this.type.required&&(e.required=!0),this.type.multiple&&-1==["radio"].indexOf(this.type.datatype)&&(e.multiple=!0),this.type.placeholder&&(e.placeholder=this.type.placeholder),this.type.maxlength&&(e.maxlength=this.type.maxlength)),e.type||(e.type="text"),e},flatSource(){let e=this.source;return e instanceof Array||(e=[]),this.getFlatSource(e)},currentComponent(){return"raas-field-"+(this.type||"text")},multilevel(){return this.flatSource.filter((e=>e.level>0)).length>0}},watch:{modelValue(e,t){JSON.stringify(e)!=JSON.stringify(t)&&(this.pValue=this.modelValue)}}}],props:{placeholder:{type:String},accept:{type:String}},data:()=>({fileName:null,dragOver:!1}),methods:{getFileDataURL:e=>new Promise(((t,l)=>{var a=new FileReader;a.onload=()=>{t(a.result)},a.onerror=l,a.readAsDataURL(e)})),getExtension(e){const t=e.split(".");return(t.length>1?t[t.length-1]:"").toLowerCase()},checkIfFileIsAllowed(e){const t=this.getExtension(e.name),l=e.type.toLowerCase();return!this.allowedTypes||!this.allowedTypes.length||-1!=this.allowedTypes.indexOf(t)||-1!=this.allowedTypes.indexOf(l)},changeFile(e){let t=(e.target||window.event.srcElement).files;t&&t.length&&this.checkIfFileIsAllowed(t[0])?(this.fileName=t[0].name,this.$emit("update:modelValue",this.fileName)):(this.fileName="",this.$refs.input.value="",this.$emit("update:modelValue",""))},clearFile(){this.fileName="",this.$refs.input.value="",this.$emit("update:modelValue","")},chooseFile(){this.$refs.input.click()},handleDrop(e){}},computed:{allowedTypes(){if(!this.accept)return null;let e=this.accept.split(",");return e=e.map((e=>e.replace(".",""))).filter((e=>!!e)).map((e=>e.toLowerCase())),e},iconCSSClass(){let e={};if(this.fileName){let t=/\.(\w+)\s*$/;if(t.test(this.fileName)){e["raas-field-file__icon_"+t.exec(this.fileName)[1].toLowerCase()]=!0}}return e}}}],methods:{handleDrop(e){const t=e.dataTransfer.files;this.$refs.input.files=t,this.changeFile({target:{files:t}})}}},x=(0,s.A)(I,[["render",function(e,t,a,o,r,n){const s=(0,l.resolveComponent)("raas-icon");return(0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createCommentVNode)(" "),(0,l.createElementVNode)("label",{onDragover:t[1]||(t[1]=(0,l.withModifiers)((t=>e.dragOver=!0),["prevent"])),onDragleave:t[2]||(t[2]=t=>e.dragOver=!1),onDrop:t[3]||(t[3]=(0,l.withModifiers)((t=>{n.handleDrop(t),e.dragOver=!1}),["prevent"])),class:(0,l.normalizeClass)(["priceloader-file-field",{"priceloader-file-field_drag":e.dragOver}])},[(0,l.createElementVNode)("input",(0,l.mergeProps)({type:"file"},e.$attrs,{accept:e.accept,ref:"input",class:"priceloader-file-field__input",onChange:t[0]||(t[0]=t=>e.changeFile(t))}),null,16,w),(0,l.createVNode)(s,{icon:"file-excel-o"}),e.fileName?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createTextVNode)((0,l.toDisplayString)(e.fileName),1)],64)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createTextVNode)((0,l.toDisplayString)(e.$root.translations.PLEASE_CHOOSE_OR_DRAG_PRICE_FILE),1)],64))],34)],2112)}],["__scopeId","data-v-0006301c"]]),O={class:"priceloader-table__letters-row"},L={class:"priceloader-table__columns-row"},A=["value"],F={key:0,class:"priceloader-table__unique-label"},T={key:0,class:"priceloader-table__rows-separator"},P=["colspan"],R=["onClick"],U={key:0,class:"priceloader-table__rows-separator"},M=["colspan"],q={key:0},H={class:"priceloader-table__total-rows"},j=["colspan"];const z={props:{loader:{type:Object,default:()=>({})},loaderData:{type:Object,default:()=>({})}},data(){const e={rows:this.loaderData.startRow,rowsSortCounter:0,columns:[]};for(let t=0;t<this.loaderData.columns.length;t++)e.columns.push(this.loaderData.columns[t].columnId);return e},mounted(){let e=null;$("tbody",this.$el).sortable({axis:"y",cancel:"tr:not(.priceloader-table__rows-separator)",containment:"parent",start:(t,l)=>{e=l.item.parent().children().index(l.item)},stop:(t,l)=>{let a=l.item.parent().children().index(l.item);a!=e&&(this.rows=a,window.setTimeout((()=>{this.rowsSortCounter++}))),e=null}})},methods:{getLetter(e){let t="",l=e+1;do{const e=(l-1)%26;t=String.fromCharCode(e+65)+t,l=Math.floor((l-e-1)/26)}while(l>0);return t},getLoaderColumn(e){let t=this.columns[e],l=null;return t&&this.loader.columns[t+""]&&(l=this.loader.columns[t+""]),l},isUniqueColumn(e){let t=this.getLoaderColumn(e);return t&&this.loader.ufid==t.fid},getColumnsSource(e){const t=[],l=Object.values(this.loader.columns);for(let e=0;e<l.length;e++){let a=l[e];t.push({value:a.id,caption:a.name})}return t},setColumnIndex(e,t){parseInt(t);const l=[];for(let a=0;a<this.columns.length;a++)a==e?l.push(t):this.columns[a]==t?l.push(null):l.push(this.columns[a]);this.columns=l}}},G=(0,s.A)(z,[["render",function(e,t,a,o,r,n){const s=(0,l.resolveComponent)("raas-field-select");return(0,l.openBlock)(),(0,l.createElementBlock)("table",{class:"priceloader-table",style:(0,l.normalizeStyle)({"--columns":a.loaderData.columns.length})},[(0,l.createElementVNode)("thead",null,[(0,l.createElementVNode)("tr",O,[t[0]||(t[0]=(0,l.createElementVNode)("th",null,null,-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a.loaderData.columns,((e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)("th",null,(0,l.toDisplayString)(n.getLetter(t)),1)))),256))]),(0,l.createElementVNode)("tr",L,[(0,l.createElementVNode)("th",null,[(0,l.createElementVNode)("input",{type:"hidden",name:"rows",value:e.rows},null,8,A)]),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a.loaderData.columns,((t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)("th",{class:(0,l.normalizeClass)(["priceloader-table__field",{"priceloader-table__field_unique":n.isUniqueColumn(a)}])},[(0,l.createVNode)(s,{name:"columns[]",source:n.getColumnsSource(a),placeholder:"--","model-value":e.columns[a],"onUpdate:modelValue":e=>n.setColumnIndex(a,e)},null,8,["source","model-value","onUpdate:modelValue"]),n.isUniqueColumn(a)?((0,l.openBlock)(),(0,l.createElementBlock)("div",F,(0,l.toDisplayString)(e.$root.translations.UNIQUE),1)):(0,l.createCommentVNode)("v-if",!0)],2)))),256))])]),(0,l.createElementVNode)("tbody",null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a.loaderData.rows,((t,o)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:o+"_"+e.rowsSortCounter},[o==e.rows?((0,l.openBlock)(),(0,l.createElementBlock)("tr",T,[(0,l.createElementVNode)("td",{colspan:a.loaderData.columns.length+1},null,8,P)])):(0,l.createCommentVNode)("v-if",!0),(0,l.createElementVNode)("tr",{class:(0,l.normalizeClass)(["priceloader-table__row",{"priceloader-table__row_inactive":o<e.rows,"priceloader-table__row_page":1==t.cells.map((e=>e.rawValue.trim())).filter((e=>""!==e)).length}])},[(0,l.createElementVNode)("th",{onClick:t=>e.rows=o},(0,l.toDisplayString)(parseInt(o)+1),9,R),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a.loaderData.columns,((a,o)=>((0,l.openBlock)(),(0,l.createElementBlock)("td",{class:(0,l.normalizeClass)(["priceloader-table__cell",{"priceloader-table__cell_inactive":!e.columns[o]}])},(0,l.toDisplayString)(t.cells[o]?t.cells[o].rawValue:""),3)))),256))],2)],64)))),128)),e.rows==a.loaderData.rows.length?((0,l.openBlock)(),(0,l.createElementBlock)("tr",U,[(0,l.createElementVNode)("td",{colspan:a.loaderData.columns.length+1},null,8,M)])):(0,l.createCommentVNode)("v-if",!0)]),a.loader.totalRows>a.loaderData.rows.length?((0,l.openBlock)(),(0,l.createElementBlock)("tfoot",q,[(0,l.createElementVNode)("tr",H,[t[1]||(t[1]=(0,l.createElementVNode)("th",null,null,-1)),(0,l.createElementVNode)("th",{colspan:a.loaderData.columns.length},(0,l.toDisplayString)(e.$root.translations.TOTAL_ROWS)+": "+(0,l.toDisplayString)(a.loader.totalRows),9,j)])])):(0,l.createCommentVNode)("v-if",!0)],4)}],["__scopeId","data-v-050edc28"]]),Y={class:"priceloader-result-table__columns-row"},J={key:0,class:"priceloader-result-table__unique-label"},Q={class:"priceloader-result-table__row"},K=["colspan"],W={class:"priceloader-result-table__cell"};const X={props:{loader:{type:Object,default:()=>({})},loaderData:{type:Object,default:()=>({})}},methods:{getLoaderColumn(e){let t=this.columns[e],l=null;return t&&this.loader.columns[t+""]&&(l=this.loader.columns[t+""]),l},isUniqueColumn(e){let t=this.getLoaderColumn(e);return t&&this.loader.ufid==t.fid}},computed:{columns(){const e=[];for(let t=0;t<this.loaderData.columns.length;t++){const l=this.loaderData.columns[t].columnId;if(l&&this.loader.columns[l+""]){const a={...this.loader.columns[l+""]};a.index=t,a.unique=this.loader.ufid==a.fid,e.push(a)}}return e}}},Z={components:{"priceloader-file-field":x,"priceloader-table":G,"priceloader-result-table":(0,s.A)(X,[["render",function(e,t,a,o,r,n){const s=(0,l.resolveComponent)("raas-icon");return(0,l.openBlock)(),(0,l.createElementBlock)("table",{class:"priceloader-result-table",style:(0,l.normalizeStyle)({"--columns":a.loaderData.columns.length})},[(0,l.createElementVNode)("thead",null,[(0,l.createElementVNode)("tr",Y,[t[0]||(t[0]=(0,l.createElementVNode)("th",null,null,-1)),(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.$root.translations.PAGE_MATERIAL),1),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(n.columns,(t=>((0,l.openBlock)(),(0,l.createElementBlock)("th",{class:(0,l.normalizeClass)(["priceloader-result-table__field",{"priceloader-result-table__field_unique":t.unique}])},[(0,l.createElementVNode)("div",null,(0,l.toDisplayString)(t.name),1),t.unique?((0,l.openBlock)(),(0,l.createElementBlock)("div",J,(0,l.toDisplayString)(e.$root.translations.UNIQUE),1)):(0,l.createCommentVNode)("v-if",!0)],2)))),256))])]),(0,l.createElementVNode)("tbody",null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a.loaderData.rows,((t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[t.type&&t.entity&&t.entity.length?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(t.entity,(o=>((0,l.openBlock)(),(0,l.createElementBlock)("tr",Q,[(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(parseInt(a)+1),1),(0,l.createElementVNode)("th",{class:(0,l.normalizeClass)(["priceloader-result-table__entity",{"priceloader-result-table__entity_page":"page"==t.type}]),colspan:"page"==t.type?n.columns.length+1:1,style:(0,l.normalizeStyle)({"--level":o.level})},[((0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(isNaN(o.id)?"span":"a"),{href:isNaN(o.id)?null:"?p=cms"+("material"==t.type?"&action=edit_material":"")+"&id="+o.id,title:e.$root.translations["PRICELOADER_LEGEND_"+(t.type+"_"+t.action+("e"==t.action.substr(-1)?"d":"ed")).toUpperCase()],target:"_blank"},{default:(0,l.withCtx)((()=>["select"==t.action?((0,l.openBlock)(),(0,l.createBlock)(s,{key:0,icon:"folder-open",class:"text-primary"})):"create"==t.action?((0,l.openBlock)(),(0,l.createBlock)(s,{key:1,icon:"plus",class:"text-success"})):"update"==t.action?((0,l.openBlock)(),(0,l.createBlock)(s,{key:2,icon:"pencil",class:"text-warning"})):(0,l.createCommentVNode)("v-if",!0),(0,l.createTextVNode)(" "+(0,l.toDisplayString)(o.name),1)])),_:2},1032,["href","title"]))],14,K),"page"!=t.type?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(n.columns,(e=>((0,l.openBlock)(),(0,l.createElementBlock)("td",W,(0,l.toDisplayString)(t.cells[e.index]?t.cells[e.index].value:""),1)))),256)):(0,l.createCommentVNode)("v-if",!0)])))),256)):(0,l.createCommentVNode)("v-if",!0)],64)))),256))])],4)}],["__scopeId","data-v-4f86bca8"]])},props:{loader:{type:Object,default:()=>({})},step:{type:Number,default:0},loaderData:{type:Object,default:()=>({})}},data:()=>({}),mounted(){},methods:{getStepHref(e){let t=window.location.search;return t=t.replace(/(\?|&)step=\w+/gi,""),e&&(t+=(t?"&":"?")+"step="+e),t}},computed:{prevHref(e){return this.getStepHref(this.step-1)}}},ee={components:{"priceloader-steps":i,"priceloader-form":(0,s.A)(Z,[["render",function(e,t,a,o,r,n){const s=(0,l.resolveComponent)("raas-icon"),i=(0,l.resolveComponent)("raas-field-select"),w=(0,l.resolveComponent)("priceloader-table"),S=(0,l.resolveComponent)("priceloader-result-table"),I=(0,l.resolveComponent)("priceloader-file-field");return(0,l.openBlock)(),(0,l.createElementBlock)("form",c,[(0,l.createElementVNode)("div",d,[1==a.step?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createElementVNode)("div",p,[(0,l.createElementVNode)("p",null,[(0,l.createVNode)(s,{icon:"exclamation-triangle"}),(0,l.createElementVNode)("strong",null,(0,l.toDisplayString)(e.$root.translations.PRICELOADER_STEP_MATCHING_HINT_HEADER),1)]),(0,l.createElementVNode)("div",{innerHTML:e.$root.translations.PRICELOADER_STEP_MATCHING_HINT},null,8,m)]),(0,l.createElementVNode)("div",u,[(0,l.createElementVNode)("label",h,(0,l.toDisplayString)(e.$root.translations.CATEGORY)+": ",1),(0,l.createElementVNode)("div",V,[(0,l.createVNode)(i,{class:"span5",name:"cat_id",source:a.loader.fields.cat_id.source,"model-value":a.loaderData.rootCategoryId,required:!0},null,8,["source","model-value"])])]),(0,l.createElementVNode)("div",f,[(0,l.createVNode)(w,{loader:a.loader,"loader-data":a.loaderData},null,8,["loader","loader-data"])])],64)):2==a.step?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createElementVNode)("div",y,[(0,l.createVNode)(s,{icon:"exclamation-triangle"}),(0,l.createElementVNode)("strong",null,(0,l.toDisplayString)(e.$root.translations.PRICELOADER_STEP_APPLY_HINT),1)]),(0,l.createElementVNode)("div",g,[(0,l.createVNode)(S,{loader:a.loader,"loader-data":a.loaderData},null,8,["loader","loader-data"])])],64)):3==a.step?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createElementVNode)("div",E,[(0,l.createVNode)(s,{icon:"check-circle"}),(0,l.createElementVNode)("strong",null,(0,l.toDisplayString)(e.$root.translations.PRICE_SUCCESSFULLY_UPLOADED),1)]),(0,l.createElementVNode)("h2",null,(0,l.toDisplayString)(e.$root.translations.UPLOAD_RESULTS),1),(0,l.createElementVNode)("div",k,[(0,l.createVNode)(S,{loader:a.loader,"loader-data":a.loaderData},null,8,["loader","loader-data"])])],64)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createElementVNode)("div",N,[(0,l.createVNode)(s,{icon:"exclamation-triangle"}),(0,l.createElementVNode)("strong",{innerHTML:e.$root.translations.PRICELOADER_STEP_UPLOAD_HINT},null,8,_)]),(0,l.createElementVNode)("div",v,[(0,l.createVNode)(I,{accept:".xls,.xlsx,.csv",name:"file"})])],64))]),(0,l.createElementVNode)("div",b,[a.step>0&&a.step<3?((0,l.openBlock)(),(0,l.createElementBlock)("a",{key:0,href:n.prevHref,class:"btn btn-large"},"« "+(0,l.toDisplayString)(e.$root.translations.BACK),9,B)):(0,l.createCommentVNode)("v-if",!0),2==a.step?((0,l.openBlock)(),(0,l.createElementBlock)("button",{key:1,type:"submit",class:"btn btn-large btn-warning",onclick:"return confirm('"+e.$root.translations.PRICELOADER_APPLY_CONFIRM+"')"},[(0,l.createVNode)(s,{icon:"check-circle"}),(0,l.createTextVNode)(" "+(0,l.toDisplayString)(e.$root.translations.APPLY),1)],8,C)):3==a.step?((0,l.openBlock)(),(0,l.createElementBlock)("a",{key:2,href:n.getStepHref(0),class:"btn btn-large btn-success"},[(0,l.createVNode)(s,{icon:"check-circle"}),(0,l.createTextVNode)(" "+(0,l.toDisplayString)(e.$root.translations.PRICELOADER_STEP_DONE),1)],8,D)):((0,l.openBlock)(),(0,l.createElementBlock)("button",{key:3,type:"submit",class:(0,l.normalizeClass)(["btn btn-large btn-success",{"btn-success":a.step>=4,"btn-primary":a.step<4}])},(0,l.toDisplayString)(e.$root.translations.GO_NEXT)+" » ",3))])])}],["__scopeId","data-v-694e8bec"]])},props:{loader:{type:Object,default:()=>({})},step:{type:Number,default:0},loaderData:{type:Object,default:()=>({})}}},te={"cms-shop-priceloader":(0,s.A)(ee,[["render",function(e,t,o,r,n,s){const i=(0,l.resolveComponent)("priceloader-steps"),c=(0,l.resolveComponent)("priceloader-form");return(0,l.openBlock)(),(0,l.createElementBlock)("div",a,[(0,l.createVNode)(i,{class:"priceloader__steps",step:o.step},null,8,["step"]),(0,l.createVNode)(c,{class:"priceloader__form",loader:o.loader,step:o.step,"loader-data":o.loaderData},null,8,["loader","step","loader-data"])])}]])},le={"data-role":"multitable"},ae={class:"cms-shop-edit-order-items raas-repo-table table table-striped"},oe=["value"],re={style:{"text-align":"right","white-space":"nowrap"}},ne={class:"raas-repo-table__controls"},se={colspan:"2"},ie={style:{"text-align":"right","white-space":"nowrap"}};const ce={props:{required:{type:Boolean,required:!1,default:!1},modelValue:{default:()=>[]},defval:{default:null},horizontal:{type:Boolean,required:!1,default:!1},sortable:{type:Boolean,default:!0},insertable:{type:Boolean,default:!0}},emits:["update:modelValue"],data(){let e={autoIncrement:0};return e.pValue=[...this.modelValue],e.items=[],e},mounted(){this.initItems()},methods:{initItems(){if(this.autoIncrement=0,this.items=[],this.pValue instanceof Array)for(let e=0;e<this.pValue.length;e++)this.items.push({id:++this.autoIncrement,value:this.pValue[e]});this.required&&!this.items.length&&this.items.push({id:++this.autoIncrement,value:null})},changeItem(e){e.target.value=e.value,this.pValue=this.items.map((e=>e.value)),this.$emit("update:modelValue",this.pValue)},sort(e){this.items.splice(e.position,0,this.items.splice(e.originalPosition,1)[0]),this.pValue=this.items.map((e=>e.value)),this.$emit("update:modelValue",this.pValue)},addItem(){this.items.push({id:++this.autoIncrement,value:this.defval}),this.pValue=this.items.map((e=>e.value)),this.$emit("update:modelValue",this.pValue)},deleteItem(e){this.items=this.items.filter((t=>t.id!=e.id)),this.pValue=this.items.map((e=>e.value)),this.$emit("update:modelValue",this.pValue)}},watch:{modelValue(e,t){JSON.stringify(e)!=JSON.stringify(t)&&(this.pValue=this.modelValue,this.initItems())}}},de={mixins:[ce],props:{cartTypeId:{type:Number,required:!0},menu:{type:Array,required:!0},defval:{type:Object,default:()=>({material:null,name:"",meta:"",realprice:"",amount:""})},sortable:{type:Boolean,default:!0}},methods:{formatPrice:e=>window.formatPrice(e),changeItem(e){const t={...e};e.target.value.material&&e.target.value.material.id||!e.value.material||!e.value.material.id||(t.value.name=t.value.material.name,t.value.material.price&&(t.value.realprice=t.value.material.price)),ce.methods.changeItem.call(this,t)}},computed:{sum(){let e=0;for(let t of this.pValue)t.realprice&&t.amount&&parseFloat(t.realprice)&&parseFloat(t.amount)&&(e+=parseFloat(t.realprice)*parseFloat(t.amount));return e}}},pe=(0,s.A)(de,[["render",function(e,t,a,o,r,n){const s=(0,l.resolveComponent)("raas-field-ajax"),i=(0,l.resolveComponent)("raas-field-text"),c=(0,l.resolveComponent)("raas-field-number"),d=(0,l.resolveComponent)("raas-repo-table-list"),p=(0,l.resolveComponent)("all-context-menu");return(0,l.openBlock)(),(0,l.createElementBlock)("div",le,[(0,l.createElementVNode)("table",ae,[(0,l.createElementVNode)("thead",null,[(0,l.createElementVNode)("tr",null,[t[4]||(t[4]=(0,l.createElementVNode)("th",null,[(0,l.createElementVNode)("input",{type:"checkbox","data-role":"checkbox-all",value:"all"})],-1)),(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.$root.translations.MATERIAL),1),(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.$root.translations.NAME),1),(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.$root.translations.ADDITIONAL_INFO),1),(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.$root.translations.PRICE),1),(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.$root.translations.AMOUNT),1),(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.$root.translations.SUM),1),t[5]||(t[5]=(0,l.createElementVNode)("th",null,null,-1))])]),(0,l.createVNode)(d,{class:"raas-repo-table__list",horizontal:e.horizontal,sortable:a.sortable&&e.items.length>1,required:e.required,"model-value":e.items,"onUpdate:modelValue":t[0]||(t[0]=e=>{n.changeItem(e)}),onSort:t[1]||(t[1]=t=>a.sortable&&e.sort(t)),onDelete:t[2]||(t[2]=t=>{e.deleteItem(t)})},{default:(0,l.withCtx)((e=>[(0,l.createElementVNode)("td",null,[e.modelValue.material&&e.modelValue.material.id?((0,l.openBlock)(),(0,l.createElementBlock)("input",{key:0,type:"checkbox","data-role":"checkbox-row",value:e.modelValue.material.id+"_"+e.modelValue.meta},null,8,oe)):(0,l.createCommentVNode)("v-if",!0)]),(0,l.createElementVNode)("td",null,[(0,l.createVNode)(s,{name:"material[]","autocomplete-url":"ajax.php?p=cms&m=shop&sub=main&action=get_materials_by_field&cart_type="+a.cartTypeId+"&search_string=","model-value":e.modelValue.material,"onUpdate:modelValue":t=>e.emit("update:modelValue",{...e.modelValue,material:t})},null,8,["autocomplete-url","model-value","onUpdate:modelValue"])]),(0,l.createElementVNode)("td",null,[(0,l.createVNode)(i,{class:"span2",name:"material_name[]","model-value":e.modelValue.name,"onUpdate:modelValue":t=>e.emit("update:modelValue",{...e.modelValue,name:t})},null,8,["model-value","onUpdate:modelValue"])]),(0,l.createElementVNode)("td",null,[(0,l.createVNode)(i,{class:"span2",name:"meta[]","model-value":e.modelValue.meta,"onUpdate:modelValue":t=>e.emit("update:modelValue",{...e.modelValue,meta:t})},null,8,["model-value","onUpdate:modelValue"])]),(0,l.createElementVNode)("td",null,[(0,l.createVNode)(c,{style:{width:"5em"},name:"realprice[]",step:"0.01","model-value":e.modelValue.realprice,"onUpdate:modelValue":t=>e.emit("update:modelValue",{...e.modelValue,realprice:t})},null,8,["model-value","onUpdate:modelValue"])]),(0,l.createElementVNode)("td",null,[(0,l.createVNode)(c,{class:"span1",name:"amount[]",step:"0.01","model-value":e.modelValue.amount,"onUpdate:modelValue":t=>e.emit("update:modelValue",{...e.modelValue,amount:t})},null,8,["model-value","onUpdate:modelValue"])]),(0,l.createElementVNode)("td",re,[e.modelValue.realprice&&e.modelValue.amount&&parseFloat(e.modelValue.realprice)&&parseFloat(e.modelValue.amount)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createTextVNode)((0,l.toDisplayString)(n.formatPrice(parseFloat(e.modelValue.realprice)*parseFloat(e.modelValue.amount))),1)],64)):(0,l.createCommentVNode)("v-if",!0)])])),_:1},8,["horizontal","sortable","required","model-value"]),(0,l.createElementVNode)("tfoot",ne,[(0,l.createElementVNode)("tr",null,[(0,l.createElementVNode)("td",se,[(0,l.createVNode)(p,{menu:a.menu},null,8,["menu"])]),t[6]||(t[6]=(0,l.createElementVNode)("td",{colspan:"3"},null,-1)),(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.$root.translations.ROLLUP),1),(0,l.createElementVNode)("th",ie,(0,l.toDisplayString)(n.formatPrice(n.sum)),1),(0,l.createElementVNode)("td",null,[(0,l.createElementVNode)("button",{type:"button",class:"btn cms-shop-edit-order-items__add",onClick:t[3]||(t[3]=t=>e.addItem())})])])])])])}]]);window.raasComponents={...window.raasComponents,...te,"cms-shop-edit-order-items":pe}})();